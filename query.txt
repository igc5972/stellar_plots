SELECT TOP 1000
s.apogee_id, s.ra, s.dec, s.glon, s.glat, 
s.vhelio_avg,s.vscatter,
a.teff, a.teff_err, a.logg, a.logg_err, a.m_h, a.m_h_err,
a.alpha_m, a.alpha_m_err,
dbo.fApogeeAspcapFlagN(a.aspcapflag),
dbo.fApogeeStarFlagN(s.starflag)
FROM apogeeStar s
JOIN aspcapStar a on a.apstar_id = s.apstar_id
WHERE (a.aspcapflag & dbo.fApogeeAspcapFlag('STAR_BAD')) = 0 and
(s.apogee_target1 &
(dbo.fApogeeTarget1('APOGEE_SHORT')+
dbo.fApogeeTarget1('APOGEE_INTERMEDIATE')+
dbo.fApogeeTarget1('APOGEE_LONG'))) != 0